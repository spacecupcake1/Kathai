<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <link
      href="../static/css/main.css"
      type="text/css"
      th:href="@{/css/main.css}"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    <script
      href="../static/js/index.js"
      type="text/javascript"
      th:src="@{/js/index.js}"
    ></script>
    <title>Genre Chart</title>
  </head>

  <body>
    <div class="item1">
      <img
        src="../static/images/f3.png"
        th:src="@{/images/f3.png}"
        alt="Title"
      />
    </div>

    <div class="item2">
      <button class="openbtn" onclick="openNav()"><span>â˜° Menu</span></button>
      <div id="mySidebar" class="sidebar">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">x</a>

        <a href="bookList.html" class="active">Home</a><br />
        <a href="https://spacecupcake1.github.io/Kathai/HTML/form.html"
          >Contact Form</a
        >
      </div>
    </div>

    <div class="transbox">
      <div class="grid-container">
        <div class="item3">
          <h1 style="text-align: center">Book Genre Analysis</h1>
          <div style="text-align: center">
            <canvas id="bookshelfPieChart" class="pie-chart"></canvas>
            <br />
            <br />
            <br />
            <canvas id="bookshelfBarChart" class="bar-chart"></canvas>
          </div>
        </div>

        <div class="item4">
          <!-- <b>footer</b> -->
        </div>
      </div>
    </div>

    <script th:inline="javascript">
      /*<![CDATA[*/
      var bookshelfCounts = /*[[${bookshelfCountsJson}]]*/ "{}";
      bookshelfCounts = JSON.parse(bookshelfCounts);
      console.log("Parsed Bookshelf Counts: ", bookshelfCounts);

      var pieCtx = document
        .getElementById("bookshelfPieChart")
        .getContext("2d");
      var barCtx = document
        .getElementById("bookshelfBarChart")
        .getContext("2d");

      // Pie Chart
      new Chart(pieCtx, {
        type: "pie",
        data: {
          labels: Object.keys(bookshelfCounts),
          datasets: [
            {
              label: "Bookshelf Counts",
              data: Object.values(bookshelfCounts),
              backgroundColor: [
                "rgba(138, 0, 0, 1)",
                "rgba(54, 162, 235, 0.6)",
                "rgba(255, 206, 86, 0.6)",
                "rgba(75, 192, 192, 0.6)",
                "rgba(255, 159, 64, 0.2)",
                "rgba(138, 229, 0, 1)",
                "rgba(90, 255, 234, 0.8)",
                "rgba(54, 162, 235, 0.4)",
                "rgba(255, 206, 86, 0.4)",
                "rgba(75, 192, 192, 0.4)",
                "rgba(153, 102, 255, 0.4)",
                "rgba(255, 159, 64, 0.4)",
                "rgba(255, 99, 132, 0.6)",
                "rgba(255, 154, 71, 0.8)",
                "rgba(255, 206, 86, 0.6)",
                "rgba(75, 192, 192, 0.6)",
                "rgba(153, 102, 255, 0.6)",
                "rgba(255, 99, 71, 0.8)",
                "rgba(54, 162, 235, 0.8)",
              ],
              borderColor: [
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
              ],
              borderWidth: 1,
            },
          ],
        },
        options: {
          title: {
            display: true,
            text: "Pie Chart",
            fontSize: 40,
          },
          legend: {
            display: true,
            position: "right",
            labels: {
              fontColor: "rgb(0, 0, 0)",
              fontSize: 15,
            },
          },
          responsive: true,
        },
      });

      // Bar Chart with Percentages
      new Chart(barCtx, {
        type: "bar",
        data: {
          labels: Object.keys(bookshelfCounts),
          datasets: [
            {
              label: "Percentages",
              data: Object.values(bookshelfCounts).map(function (value) {
                return (
                  (value /
                    Object.values(bookshelfCounts).reduce((a, b) => a + b, 0)) *
                  100
                ).toFixed(2);
              }),
              backgroundColor: [
                "rgba(138, 0, 0, 1)",
                "rgba(54, 162, 235, 0.6)",
                "rgba(255, 206, 86, 0.6)",
                "rgba(75, 192, 192, 0.6)",
                "rgba(255, 159, 64, 0.2)",
                "rgba(138, 229, 0, 1)",
                "rgba(90, 255, 234, 0.8)",
                "rgba(54, 162, 235, 0.4)",
                "rgba(255, 206, 86, 0.4)",
                "rgba(75, 192, 192, 0.4)",
                "rgba(153, 102, 255, 0.4)",
                "rgba(255, 159, 64, 0.4)",
                "rgba(255, 99, 132, 0.6)",
                "rgba(255, 154, 71, 0.8)",
                "rgba(255, 206, 86, 0.6)",
                "rgba(75, 192, 192, 0.6)",
                "rgba(153, 102, 255, 0.6)",
                "rgba(255, 99, 71, 0.8)",
                "rgba(54, 162, 235, 0.8)",
              ],
              borderColor: [
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
                "rgba(0, 0, 0, 1)",
              ],
              borderWidth: 1,
            },
          ],
        },
        options: {
          title: {
            display: true,
            text: "Bar Chart with Percentage",
            fontSize: 30,
          },
          legend: {
            display: false,
          },
          responsive: true,
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              ticks: {
                stepSize: 10,
              },
            },
            x: {
              ticks: {
                callback: function (value) {
                  return value + "%";
                },
              },
            },
          },
        },
      });

      /*]]>*/
    </script>
  </body>
</html>
